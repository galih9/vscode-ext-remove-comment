/* media/jsonViewer.css */

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    background-color: var(--vscode-editor-background);
    color: var(--vscode-editor-foreground);
    margin: 0;
    padding: 10px;
    overflow: auto;
    font-size: 13px;
}

/* --- Styles for the new control buttons (Expand All / Collapse All / Show/Hide Copy) --- */
.controls {
    margin-bottom: 10px;
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.controls button {
    background-color: var(--vscode-button-background);
    color: var(--vscode-button-foreground);
    border: none;
    padding: 6px 12px;
    border-radius: 3px;
    cursor: pointer;
    font-size: 12px;
    outline: none;
    flex-shrink: 0;
}

.controls button:hover {
    background-color: var(--vscode-button-hoverBackground);
}

.controls button:active {
    background-color: var(--vscode-button-background);
}

/* --- End Styles for control buttons --- */


/* Base list styling for the JSON tree */
.json-viewer ul {
    list-style-type: none;
    padding-left: 20px;
    margin: 0;
    position: relative;
}

/* Vertical line for the parent branch of an object/array */
.json-viewer ul:not(:first-child) {
    border-left: 1px solid var(--vscode-editorGroup-border);
}

/* Styling for each JSON list item (li) */
.json-viewer li {
    line-height: 1.5;
    white-space: nowrap;
    padding-bottom: 2px;
    margin-bottom: 2px;
    border-bottom: 1px solid var(--vscode-editorGroup-border);
    position: relative;
    /* REMOVED: display: flex; align-items: center; from here */
    /* This makes children lay out vertically by default again */
}

/* Remove the bottom border for the very last item in any given list (ul) */
.json-viewer li:last-child {
    border-bottom: none;
}

/* --- Tree Line Drawing --- */
/* Horizontal connector line for each item */
.json-viewer li::before {
    content: "";
    position: absolute;
    top: 1em; /* Align with the text baseline */
    left: -20px;
    width: 15px;
    height: 0;
    border-top: 1px solid var(--vscode-editorGroup-border);
    z-index: 1;
}

/* Vertical line segments for items that are not the last child */
.json-viewer li:not(:last-child)::after {
    content: "";
    position: absolute;
    top: 1em; /* Start from the text baseline */
    left: -20px;
    width: 0;
    height: calc(100% - 1em + 2px + 2px); /* Extends to next item's line */
    border-left: 1px solid var(--vscode-editorGroup-border);
    z-index: 1;
}

/* Adjustments for the very first (root) li element's horizontal line */
body > #json-tree-container > ul > li::before {
    left: -15px;
    width: 10px;
}

/* Prevent vertical line from extending past the last child in a list (ul) */
body > #json-tree-container > ul > li:last-child::after,
.json-viewer ul li:last-child > .node-children > li:last-child::after {
    border-left: none;
}
.json-viewer ul li:last-child > .node-children {
    border-left: none;
}

/* --- Core Expand/Collapse Logic for Children --- */
.json-viewer li.collapsed > .node-children {
    display: none;
}
.json-viewer li.expanded > .node-children {
    display: block;
}


/* --- NEW: Wrapper for Node Header and Copy Button --- */
.node-line-content {
    display: flex; /* This is now the flex container */
    align-items: center;
    padding: 2px 0; /* Add back padding lost from li */
    margin-left: 5px; /* Adjust for tree line space */
}

/* Flex container for the content within each list item header */
.node-header {
    display: flex; /* Keep this for internal header alignment */
    align-items: center;
    cursor: pointer;
    user-select: none;
    /* padding: 2px 0; REMOVED, moved to .node-line-content */
    /* margin-left: 5px; REMOVED, moved to .node-line-content */
    flex-grow: 1; /* Allow the header to take up available space */
}

/* Improved Style for the Expand/Collapse Icon (+ / -) */
.expand-icon {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    width: 1.2em;
    height: 1.2em;
    margin-right: 5px;
    font-weight: bold;
    font-size: 1.1em;
    border-radius: 3px;
    flex-shrink: 0;
    background-color: var(--vscode-button-background);
    color: var(--vscode-button-foreground);
    border: 1px solid var(--vscode-button-border, var(--vscode-button-background));
}
.expand-icon:hover {
    background-color: var(--vscode-button-hoverBackground);
}
.expand-icon.collapsed::before { content: "+"; }
.expand-icon.expanded::before { content: "-"; }
.expand-icon.empty { visibility: hidden; }


/* Data Type Indicators (colored cube) */
.type-indicator {
    width: 8px;
    height: 8px;
    border-radius: 2px;
    margin-right: 6px;
    display: inline-block;
    flex-shrink: 0;
}
.type-string { background-color: orange; }
.type-number { background-color: green; }
.type-boolean { background-color: darkblue; }
.type-null { background-color: gray; }
.type-undefined { background-color: gray; }


/* Styles for the key part of a JSON entry */
.key {
    color: var(--vscode-editor-token-keyword);
}
.key.root-key {
    font-weight: bold;
}

/* Separator (colon for key:value pairs) */
.separator {
    color: var(--vscode-editor-foreground);
    margin: 0 5px;
}

/* Primitive value styling */
.value {
    display: inline-block;
    padding: 0;
    border-radius: 3px;
    font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
}

/* Styles for the {} and [] indicators within the header */
.brace-indicator, .bracket-indicator {
    font-weight: bold;
    color: var(--vscode-editor-foreground);
    margin-right: 3px;
}

/* Object and Array specific styling for meta info (e.g., "3 items") */
.object-meta, .array-meta {
    font-style: italic;
    font-size: 7px;
    padding-left: 5px;
    color: var(--vscode-editor-lineHighlightForeground);
}

/* --- INDIVIDUAL COPY BUTTON STYLING --- */
.copy-node-btn {
    display: none; /* Will be toggled by JS */
    background-color: var(--vscode-button-background);
    color: var(--vscode-button-foreground);
    border: 1px solid var(--vscode-button-border, var(--vscode-button-background));
    padding: 2px 6px;
    border-radius: 3px;
    cursor: pointer;
    font-size: 11px;
    margin-left: 8px; /* Space from the right of the header */
    flex-shrink: 0;
    outline: none;

    /* For codicon icon alignment and text */
    display: inline-flex; /* Important: this will be overwritten by JS's style.display */
    align-items: center;
    justify-content: center;
    gap: 4px; /* Space between "Copy" text and icon */
    height: 1.5em;
}

.copy-node-btn:hover {
    background-color: var(--vscode-button-hoverBackground);
}

/* Feedback when copied */
.copy-node-btn.copied {
    background-color: var(--vscode-menu-selectionBackground);
    color: var(--vscode-menu-selectionForeground);
    transition: background-color 0.2s ease, color 0.2s ease;
}
/* --- END INDIVIDUAL COPY BUTTON STYLING --- */


/* --- Visibility Rules for Expanded/Collapsed States (Node Header Parts) --- */
/* Hide container indicators ({}, []) and meta info ("3 items") when the node is EXPANDED */
/* .json-viewer li.expanded > .node-line-content > .node-header .brace-indicator,
.json-viewer li.expanded > .node-line-content > .node-header .bracket-indicator, */
.json-viewer li.expanded > .node-line-content > .node-header .object-meta,
.json-viewer li.expanded > .node-line-content > .node-header .array-meta {
    display: none;
}

/* Ensure container indicators and meta info are VISIBLE when the node is COLLAPSED */
.json-viewer li.collapsed > .node-line-content > .node-header .brace-indicator,
.json-viewer li.collapsed > .node-line-content > .node-header .bracket-indicator,
.json-viewer li.collapsed > .node-line-content > .node-header .object-meta,
.json-viewer li.collapsed > .node-line-content > .node-header .array-meta {
    display: inline;
}
/* The colored type-indicator (.type-indicator) should ALWAYS be visible. */